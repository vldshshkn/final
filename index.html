
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Волшебный Сейф</title>
  <style>
    @font-face {
      font-family: 'DisneyPark';
      src: url('ofont.ru_DisneyPark.ttf') format('truetype');
    }

    body {
      margin: 0;
      padding: 0;
      background: url('BG.jpeg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'DisneyPark', sans-serif;
      color: white;
      text-align: center;
    }
    h1 {
      margin-top: 30px;
      font-size: 44px;
      text-shadow: 2px 2px 5px black;
    }
    .questions {
      background-color: rgba(0, 0, 0, 0.4);
      margin: 20px auto;
      padding: 20px;
      border-radius: 15px;
      width: 90%;
      max-width: 720px;
      font-size: 20px;
    }
    .safe {
      position: relative;
      margin: 0 auto;
      margin-top: 0;
      width: 500px;
    }
    .safe img {
      width: 100%;
    }
    .digits {
      position: absolute;
      top: 53%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      gap: 15px;
    }
    .digits input {
      width: 60px;
      height: 80px;
      font-size: 36px;
      text-align: center;
      border-radius: 10px;
    }
    canvas.confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      pointer-events: none;
      z-index: 9999;
    }
  </style>
</head>
<body>
  <h1>Ты молодец! Последний шаг!</h1>
  <div class="questions">
    <p>Чтобы открыть сейф, ответь на 4 вопроса:</p>
    <p>1. Сколько раз ты купалась в Персидском заливе?</p>
    <p>2. Сколько персонажей было в фильме "Там, где мы были"?</p>
    <p>3. Сколько было комнат в домике на Новый год?</p>
    <p>4. Сколько татуировок у Владика? (фото смотреть нельзя!)</p>
  </div>

  <div class="safe">
    <img src="save.png" alt="Сейф" />
    <div class="digits">
      <input type="number" min="0" max="9" id="digit1">
      <input type="number" min="0" max="9" id="digit2">
      <input type="number" min="0" max="9" id="digit3">
      <input type="number" min="0" max="9" id="digit4">
    </div>
  </div>

  <canvas class="confetti" id="confetti"></canvas>

  <audio id="bgMusic" src="background_music.mp3" loop></audio>
  <audio id="victory" src="victory_fanfare.mp3"></audio>

  <script>
    window.addEventListener('load', () => {
      const music = document.getElementById('bgMusic');
      const play = () => {
        music.volume = 0.5;
        music.play().catch(err => console.log('Автостарт заблокирован'));
        document.removeEventListener('click', play);
      };
      document.addEventListener('click', play);
    });

    const correctCode = "2856";
    const inputs = [
      document.getElementById('digit1'),
      document.getElementById('digit2'),
      document.getElementById('digit3'),
      document.getElementById('digit4')
    ];
    inputs.forEach(input => input.addEventListener('change', checkCode));

    function checkCode() {
      const enteredCode = inputs.map(i => i.value).join('');
      if (enteredCode === correctCode) {
        document.getElementById('victory').play();
        launchConfetti();
        setTimeout(() => {
          window.location.href = "https://lera-birthday.com/win";
        }, 3500);
      }
    }

    function launchConfetti() {
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const pieces = Array.from({ length: 150 }, () => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height - canvas.height,
        r: Math.random() * 6 + 4,
        d: Math.random() * 30 + 10,
        color: `hsl(${Math.random() * 360}, 100%, 70%)`,
        tilt: Math.random() * 10 - 10,
        tiltAngleIncrement: Math.random() * 0.1 + 0.05,
        tiltAngle: 0,
      }));

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (const p of pieces) {
          ctx.beginPath();
          ctx.lineWidth = p.r / 2;
          ctx.strokeStyle = p.color;
          ctx.moveTo(p.x + p.tilt + p.r / 4, p.y);
          ctx.lineTo(p.x + p.tilt, p.y + p.tilt + p.r);
          ctx.stroke();
        }
        update();
      }

      function update() {
        for (const p of pieces) {
          p.tiltAngle += p.tiltAngleIncrement;
          p.y += (Math.cos(p.d) + 3 + p.r / 2) / 2;
          p.tilt = Math.sin(p.tiltAngle) * 15;

          if (p.y > canvas.height) {
            p.y = -20;
            p.x = Math.random() * canvas.width;
          }
        }
      }

      (function animate() {
        draw();
        requestAnimationFrame(animate);
      })();
    }
  </script>
</body>
</html>
